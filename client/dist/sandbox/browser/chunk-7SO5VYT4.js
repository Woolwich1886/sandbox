import{a as x,e as Z,h as ee,i as te,l as re,m as w,n as ie}from"./chunk-BDBREKTO.js";import{Ab as o,Bb as s,Bc as X,Cb as H,E as D,Ec as Y,F as R,G as M,Gb as C,H as I,Lb as u,Mb as J,Nb as f,Ob as Q,S as A,Sb as m,Tb as h,a,b as l,e as O,ea as j,ga as N,gb as c,hb as K,ka as T,la as G,qa as L,rb as S,ta as b,ua as U,w as g,xb as V,yb as q,zb as z,zc as W}from"./chunk-BF5C4A5R.js";var v=function(e){return e.SwitchColor="[Sphere Page] Switch Color",e.Reset="[Sphere Page] Reset state",e.AddSphere="[Sphere Page] Add Sphere",e}(v||{}),y=x(v.SwitchColor,e=>({payload:e})),F=x(v.Reset),k=x(v.AddSphere,e=>({payload:e}));var B="spheres;",le=te(B),ne=ee(le,e=>e.spherePageState);var E=(()=>{let t=class t{constructor(r){this.store=r;let i=this.getState(),n=i.pipe(_("red",3e3,1)),d=i.pipe(_("blue",1200,.5)),pe=i.pipe(_("green",1400,.25)),ae=R(n,d,pe).pipe(N(ce=>this.addSphere(ce)));this.flowSub=ae.subscribe()}getSpheres(){return this.getState().pipe(g(r=>r.spheres))}getColorCount(r){let i=r+"Count";return this.getState().pipe(g(n=>n[i]))}ngOnDestroy(){this.flowSub.unsubscribe()}addSphere(r){this.store.dispatch(k(r))}reset(){this.store.dispatch(F())}switchColor(r){this.store.dispatch(y(r))}getState(){return this.store.select(ne)}};t.\u0275fac=function(i){return new(i||t)(L(Z))},t.\u0275prov=T({token:t,factory:t.\u0275fac});let e=t;return e})();function _(e,t,p){let r={red:"isRedOn",blue:"isBlueOn",green:"isGreenOn"};return O(A(r[e]),g(i=>i[r[e]]),j(i=>i?D(t).pipe(I(()=>Math.random()<p),g(()=>P(e))):M))}function P(e,t){return{color:e,number:Math.floor(t??Math.random()*10+1)}}var oe=(()=>{let t=class t{ngOnInit(){this.backgroundStyle={background:`radial-gradient(closest-corner at 40% 40%, white, ${this.color})`,"box-shadow":`2px 2px 4px 1px ${this.color}`}}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=b({type:t,selectors:[["sb-sphere"]],inputs:{color:"color",number:"number"},decls:2,vars:2,consts:[[1,"sphere",3,"ngStyle"]],template:function(i,n){i&1&&(o(0,"div",0),u(1),s()),i&2&&(S("ngStyle",n.backgroundStyle),c(1),J(n.number))},dependencies:[W],styles:[".sphere[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;border-radius:50%;height:75px;width:75px;margin:8px}"],changeDetection:0});let e=t;return e})();function fe(e,t){if(e&1&&H(0,"sb-sphere",4),e&2){let p=t.$implicit;S("color",p.color)("number",p.number)}}function ge(e,t){e&1&&u(0," \u0421\u0444\u0435\u0440\u044B \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044E\u0442... ")}var De=(()=>{let t=class t{constructor(r){this.service=r,this.sphereList$=this.service.getSpheres(),this.redCount$=this.service.getColorCount("red"),this.blueCount$=this.service.getColorCount("blue"),this.greenCount$=this.service.getColorCount("green"),this.violetCount$=this.service.getColorCount("violet"),this.whiteCount$=this.service.getColorCount("white")}};t.\u0275fac=function(i){return new(i||t)(K(E))},t.\u0275cmp=b({type:t,selectors:[["sb-sphere-page"]],features:[Q([E])],decls:30,vars:18,consts:[[1,"control-block"],[3,"click"],[1,"main-block"],[1,"result-block"],[3,"color","number"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"button",1),C("click",function(){return n.service.switchColor("red")}),u(2,"\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u043A\u0440\u0430\u0441\u043D\u044B\u0435"),s(),o(3,"button",1),C("click",function(){return n.service.switchColor("blue")}),u(4,"\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u0441\u0438\u043D\u0438\u0435"),s(),o(5,"button",1),C("click",function(){return n.service.switchColor("green")}),u(6,"\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u0437\u0435\u043B\u0435\u043D\u044B\u0435"),s(),o(7,"button",1),C("click",function(){return n.service.reset()}),u(8,"\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C"),s()(),o(9,"div",2),q(10,fe,1,2,"sb-sphere",4,V,!1,ge,1,0),m(13,"async"),s(),o(14,"div",3)(15,"p"),u(16),m(17,"async"),s(),o(18,"p"),u(19),m(20,"async"),s(),o(21,"p"),u(22),m(23,"async"),s(),o(24,"p"),u(25),m(26,"async"),s(),o(27,"p"),u(28),m(29,"async"),s()()),i&2&&(c(10),z(h(13,6,n.sphereList$)),c(6),f("\u041A\u0440\u0430\u0441\u043D\u044B\u0435: ",h(17,8,n.redCount$),""),c(3),f("\u0421\u0438\u043D\u0438\u0435: ",h(20,10,n.blueCount$),""),c(3),f("\u0417\u0435\u043B\u0435\u043D\u044B\u0435: ",h(23,12,n.greenCount$),""),c(3),f("\u0424\u0438\u043E\u043B\u0435\u0442\u043E\u0432\u044B\u0435: ",h(26,14,n.violetCount$),""),c(3),f("\u0411\u0435\u043B\u044B\u0435: ",h(29,16,n.whiteCount$),""))},dependencies:[oe,X],styles:["[_nghost-%COMP%]{display:grid;grid-template-columns:1fr 3fr 1fr;gap:50px;margin:8px}.control-block[_ngcontent-%COMP%]{background:#F9F7F7;border:solid #112D4E 2px;box-shadow:4px 4px 8px 1px #3f72af;border-radius:8px;padding:8px;min-width:0}.main-block[_ngcontent-%COMP%]{background:#F9F7F7;border:solid #112D4E 2px;box-shadow:4px 4px 8px 1px #3f72af;border-radius:8px;padding:8px;min-width:0;height:600px;display:flex;flex-wrap:wrap;align-content:flex-start}.result-block[_ngcontent-%COMP%]{background:#F9F7F7;border:solid #112D4E 2px;box-shadow:4px 4px 8px 1px #3f72af;border-radius:8px;padding:8px;min-width:0}"],changeDetection:0});let e=t;return e})();var se={spheres:[],isRedOn:!1,isBlueOn:!1,isGreenOn:!1,redCount:0,blueCount:0,greenCount:0,violetCount:0,whiteCount:0,lastRedNumber:void 0},ue=ie(se,w(F,ve),w(k,we),w(y,Ce));function Ce(e,t){switch(t.payload){case"red":return be(e);case"blue":return Se(e);case"green":return xe(e);default:throw new Error("Unsupported color in reducer")}}function be(e){return l(a({},e),{isRedOn:!e.isRedOn})}function Se(e){return l(a({},e),{isBlueOn:!e.isBlueOn})}function xe(e){return l(a({},e),{isGreenOn:!e.isGreenOn})}function we(e,t){let p=t.payload,r=a({},e),i=[...r.spheres,p];switch(r=l(a({},r),{spheres:i}),p.color){case"red":r.redCount++,r=l(a({},r),{lastRedNumber:p.number});break;case"blue":if(r.blueCount++,p.number>(r.lastRedNumber??10)){let d=P("violet");r.violetCount++,r=l(a({},r),{spheres:[...r.spheres,d]})}break;case"green":let n=P("green");r.greenCount+=2,r=l(a({},r),{spheres:[...r.spheres,n]});break;default:throw new Error("Unsupported sphere color in reducer.")}return r}function ve(e){return se}var He=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=U({type:t}),t.\u0275inj=G({imports:[Y,re.forFeature(B,{spherePageState:ue})]});let e=t;return e})();export{De as a,He as b};
